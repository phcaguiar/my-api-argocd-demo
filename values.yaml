my-api:
  replicaCount: 1
  revisionHistoryLimit: 10
  image:
    repository: nginx
    tag: latest
  resources:
    requests:
      cpu: "150m"
      memory: "128Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"

  canary:
    steps:
      - weight: 10
        pause: 5s
      - weight: 60
        pause: 5s
      - weight: 100
        pause: 5s

  jobpostsynctest:
    enabled: true
    generateName: my-app-postsync-
    annotations:
      argocd.argoproj.io/hook: PostSync
      argocd.argoproj.io/hook-delete-policy: HookSucceeded
    backoffLimit: 1
    restartPolicy: Never
    container:
      name: post-deploy
      image: busybox
      command: ["sh", "-c"]
      args: ["for i in $(seq 1 5); do echo $i; sleep 1; done"]
